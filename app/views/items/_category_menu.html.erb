<% 
	options ||= Hash.new
	options[:category] ||= nil # no category by default, show all
%>
	<% if options[:category] %>
		<% @category = options[:category] %>
		<table cellpadding=0 cellspacing=0 style="width:100%">
			<tr>
				<td align=left  style="vertical-align:middle">
						<h2 class="title"><%= @category.name %></h2>
				</td>
				<% if !@logged_in_user.anonymous? %>				
					<td align=right style="width:105px;vertical-align:middle">
							<%= link_to icon("new") + " #{t("label.object_new", :object => @setting[:item_name])}", {:action => "new", :controller => "items"} %>						
					</td>	
				<% end %>											
			</tr>			
		</table>
		<div class="spacer"></div>
		<% for category in @category.child_categories %>
			<%= descend_category(category, :include_children => @setting[:include_child_category_items], :show_item_count => true, :depth => 0)  %>
		<% end %>			
		<%=  t("notice.objects_not_found", :objects => Category.human_attribute_name(:categories)) if @category.child_categories.size == 0 %>
	<% else %>
		<table cellpadding=0 cellspacing=0 style="width:100%">
			<tr>
				<td align=left  style="vertical-align:middle">
					<h2 class="title"><%= @setting[:item_name_plural] %></h2>
				</td>
				<% if !@logged_in_user.anonymous? %>
					<td align=right style="width:105px;vertical-align:middle">							
							<%= link_to icon("new") + " #{t("label.object_new", :object => @setting[:item_name])}", {:action => "new", :controller => "items"} %>						
					</td>	
				<% end %>												
			</tr>			
		</table>	
		<div class="spacer"></div>		
		<% for category in Category.get_parent_categories %>
			<%= descend_category(category, :include_children => @setting[:include_child_category_items], :show_item_count => true, :depth => 0)  %>		
		<% end %>	
	<% end %>




